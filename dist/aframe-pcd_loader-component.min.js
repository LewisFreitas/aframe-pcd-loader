!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n=function(e,t){var r,n,i,o=e.length,a=new Uint8Array(t),s=0,l=0;do{if((r=e[s++])<32){if(l+ ++r>t)throw new Error("Output buffer is not large enough");if(s+r>o)throw new Error("Invalid compressed data");do{a[l++]=e[s++]}while(--r)}else{if(n=r>>5,i=l-((31&r)<<8)-1,s>=o)throw new Error("Invalid compressed data");if(7===n&&(n+=e[s++],s>=o))throw new Error("Invalid compressed data");if(i-=e[s++],l+n+2>t)throw new Error("Output buffer is not large enough");if(i<0)throw new Error("Invalid compressed data");if(i>=l)throw new Error("Invalid compressed data");do{a[l++]=a[i++]}while(2+--n)}}while(s<o);return a};function i(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.loader=new THREE.XHRLoader(this.manager),this.loader.setResponseType("arraybuffer"),this.littleEndian=!0}i.prototype.load=function(e,t,r,n){var i=this;this.loader.load(e,(function(r){t(i.parse(r,e))}),r,n)},i.prototype.parse=function(e){var t=this.parseHeader(e),r=t.offset,i=!1;void 0!==r.x&&void 0!==r.y&&void 0!==r.z&&(i=new Float32Array(3*t.points));var o,a=!1;if(void 0===r.rgb&&void 0===r.rgba||(a=new Float32Array(3*t.points),o=void 0===r.rgb?r.rgba:r.rgb),"ascii"===t.data){for(var s=new Uint8Array(e),l="",d=t.headerLen;d<e.byteLength;d++)l+=String.fromCharCode(s[d]);for(var f=l.split("\n"),u=0,p=0;p<f.length;p++,u+=3){var c=f[p].split(" ");if(!1!==i&&(i[u+0]=parseFloat(c[r.x]),i[u+1]=parseFloat(c[r.y]),i[u+2]=parseFloat(c[r.z])),!1!==a){var h;void 0!==r.rgba?h=new Uint32Array([parseInt(c[r.rgba])]):void 0!==r.rgb&&(h=new Float32Array([parseFloat(c[r.rgb])]));var v=new Uint8Array(h.buffer,0);a[u+2]=v[0]/255,a[u+1]=v[1]/255,a[u+0]=v[2]/255}}}else if("binary"===t.data)for(var g=0,w=new DataView(e,t.headerLen),y=0;y<t.points;g+=t.rowSize,y++)!1!==i&&(i[3*y+0]=w.getFloat32(g+r.x,this.littleEndian),i[3*y+1]=w.getFloat32(g+r.y,this.littleEndian),i[3*y+2]=w.getFloat32(g+r.z,this.littleEndian)),!1!==a&&(a[3*y+2]=w.getUint8(g+o+0)/255,a[3*y+1]=w.getUint8(g+o+1)/255,a[3*y+0]=w.getUint8(g+o+2)/255);else if("binary_compressed"===t.data){var b=new Uint32Array(e.slice(t.headerLen,t.headerLen+8)),E=b[0],m=b[1],A=n(new Uint8Array(e,t.headerLen+8,E),m);for(w=new DataView(A.buffer),y=0;y<t.points;y++)!1!==i&&(i[3*y+0]=w.getFloat32(r.x+4*y,this.littleEndian),i[3*y+1]=w.getFloat32(r.y+4*y,this.littleEndian),i[3*y+2]=w.getFloat32(r.z+4*y,this.littleEndian)),!1!==a&&(a[3*y+2]=w.getUint8(o+4*y+0)/255,a[3*y+1]=w.getUint8(o+4*y+1)/255,a[3*y+0]=w.getUint8(o+4*y+2)/255)}var x=new THREE.BufferGeometry;!1!==i&&x.addAttribute("position",new THREE.BufferAttribute(i,3)),!1!==a&&x.addAttribute("color",new THREE.BufferAttribute(a,3));var T=new THREE.PointsMaterial({size:.005,vertexColors:!(!1===a)});!1===a&&T.color.setHex(16777215*Math.random());var I=new THREE.Points(x,T);return I.header=t,I},i.prototype.parseHeader=function(e){for(var t="",r=new Uint8Array(e),n=0,i=r.length;n<i&&-1===t.search(/[\r\n]DATA\s(\S*)\s/i);)t+=String.fromCharCode(r[n++]);var o=t.search(/[\r\n]DATA\s(\S*)\s/i),a=/[\r\n]DATA\s(\S*)\s/i.exec(t.substr(o-1)),s={};if(s.data=a[1],s.headerLen=a[0].length+o,s.str=t.substr(0,s.headerLen),s.str=s.str.replace(/\#.*/gi,""),s.version=/VERSION (.*)/i.exec(s.str),null!==s.version&&(s.version=parseFloat(s.version[1])),s.fields=/FIELDS (.*)/i.exec(s.str),null!==s.fields&&(s.fields=s.fields[1].split(" ")),s.size=/SIZE (.*)/i.exec(s.str),null!==s.size&&(s.size=s.size[1].split(" ").map((function(e){return parseInt(e,10)}))),s.type=/TYPE (.*)/i.exec(s.str),null!==s.type&&(s.type=s.type[1].split(" ")),s.count=/COUNT (.*)/i.exec(s.str),null!==s.count&&(s.count=s.count[1].split(" ").map((function(e){return parseInt(e,10)}))),s.width=/WIDTH (.*)/i.exec(s.str),null!==s.width&&(s.width=parseInt(s.width[1])),s.height=/HEIGHT (.*)/i.exec(s.str),null!==s.height&&(s.height=parseInt(s.height[1])),s.viewpoint=/VIEWPOINT (.*)/i.exec(s.str),null!==s.viewpoint&&(s.viewpoint=s.viewpoint[1]),s.points=/POINTS (.*)/i.exec(s.str),null!==s.points&&(s.points=parseInt(s.points[1],10)),null===s.points&&(s.points=s.width*s.height),null===s.count)for(s.count=[],n=0;n<s.fields;n++)s.count.push(1);s.offset={};for(var l=0,d=0;d<s.fields.length;d++)"ascii"===s.data?s.offset[s.fields[d]]=d:"binary"===s.data?(s.offset[s.fields[d]]=l,l+=s.size[d]):"binary_compressed"===s.data&&(s.offset[s.fields[d]]=l,l+=s.size[d]*s.points);return s.rowSize=l,s},THREE.EventDispatcher.constructor.prototype.apply(i.prototype);var o=i;if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("pcd_loader",{schema:{modelUrl:{type:"string",default:"model.pcd"},log:{type:"boolean",default:!1}},multiple:!1,init:function(){var e=this.el,t=new o;const r=this.data.modelUrl||"model.pcd",n=this.data.log||!1;t.load(r,t=>{e.setObject3D("mesh",t)},e=>{n&&console.log(e.loaded/e.total*100+"% loaded")},e=>{console.log(e)})},update:function(e){},remove:function(){},pause:function(){},play:function(){},events:{}})}])}));